---
title: "IPIP-0379: Delegated IPNS HTTP API"
date: 2023-02-13
ipip: proposal
editors:
  - name: Masih H. Derkani
    github: masih
  - name: Marcin Rataj
    github: lidel
    url: https://lidel.org/
relatedIssues:
  - https://github.com/ipfs/specs/issues/343
  - https://github.com/ipfs/specs/pull/337
  - https://github.com/ipfs/specs/pull/377
order: 379
tags: ['ipips']
---

- Start Date: 2023-02-13
- Related Issues:

## Summary

This IPIP specifies a set of HTTP APIs to offload naming system onto another process or server.

## Motivation

Expanding on the motivations of :cite[ipip-0337], the work here concentrates on delegation of _naming system_ over HTTP APIs. Naming is part of the core IPFS DHT functionality.
The performance of naming system over the IPFS DHT can suffer from long delays due to churn of records and quorum requirements.

## HTTP API Specification

See :cite[http-ipns-routing] specification.

## Design rationale

The rationale for delegated IPNS over HTTP APIs closely follows the reasoning listed in :cite[ipip-0337].

The document proposes the following:
- Use of HTTP semantics for publication and resolution of naming records.
- Preference for human-readable request and response encoding, such as JSON format
- Optional backward compatibility support for the existing ProtocolBuffer format using `Content-Type: application/vnd.ipfs.ipns-record`
- Use of extra headers in `OPTIONS` response to communicate the supported capabilities and limitations, namely:
  - `X-Ipns-Allow-Max-Size` -- to signal maximum supported IPNS record size
  - `X-Ipns-Allow-Protobuf` -- to signal whether the server supports ProtocolBuffer formatted records.
- Streaming interaction is not supported.

### User benefit

The ability of offload naming onto another process or server via an idiomatic and simple HTTP API opens up an opportunity to not only reduce the burden of naming system management, but also introduce alternative naming systems across other routing systems, namely IPNI.

### Compatibility

#### Backwards Compatibility

##### Serialization Format

:cite[ipns-record] use ProtocolBuffer serialisation format.
This format is widely in use in IPNS over PubSub and DHT routing systems.
One of the motivations of this document is to introduce simple to use HTTP APIs and ultimately reduce barrier for interaction across alternative systems.
Further, interoperability across the existing and HTTP APIs is also desirable in order to reduce the barrier for adoption of the delegated HTTP APIs.

The specification here maintains backwards compatibility in terms of record serialisation, with preference for human-readable formats such as JSON.
To maximize interoperability with existing ecosystem, the canonical IPNS record serialization format :cite[ipns-record] (`0x0300`) can be requested with content type `application/vnd.ipfs.ipns-record`.

##### Reframe

See "Backwards Compatibility" section of :cite[ipip-0337].

#### Forwards Compatibility

See "Forwards Compatibility" section of :cite[ipip-0337].

### Security

All interaction over the APIs should use TLS to protect against third-party observation and tampering.
Additionally, the IPNS records are signed by the publisher's identity and contain sequence number to avoid replay attacks.

To avoid Denial of Service attack, maximum IPNS record size of `10 KiB` applies.
Implements are permitted to set a lower limit. If lower than the default maximum, the limit should be discoverable via `OPTIONS` request with header key `X-Ipns-Allow-Max-Size` with value specified as the number of bytes.

Similarly, a client may check if a server supports ProtocolBuffer formatted records by checking the `X-Ipns-Allow-Protobuf` header key in response to `OPTIONS` request. If present the header value must be either `true` or `false` the absence of the header indicates that ProtocolBuffer formatted records are not supported.

Privacy in delegated IPNS is out of scope for this work.
- The usual JSON parsing rules apply. To prevent potential Denial of Service (DoS) attack, clients should ignore responses larger than 100 providers and introduce a byte size limit that is applicable to their use case.

### Alternatives

See:
- [Libp2p-based IPNS](https://github.com/ipfs/go-ipns).
- Reframe; find out more on "Design Rationale" section of :cite[ipip-0337].

### Copyright

Copyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/).
